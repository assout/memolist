# Title: Windows

Date: 2014-12-04 15:00
Tags: []
Categories: []

---

## Tools

### Use

* C/Migemo for Windows                 : for vim-migemo
* Change Key                           : キーボード配置変更(swap Ctrl and Caps Lock)
* Eclipse                              : refs. <2014-09-09-eclipse.md>
* Everything Search Engine
* Excel Sniper
* Exuberant Ctags                      : for vim
* Google Chrome                        : go to <2014-11-13-chrome.md>
* IP Messenger                         : boot on windows startup. : レジストリをいじって別ネットワークセグメントへ通信。
* MSYS2
* Pandoc                               : markdown - textile 変換 等。
* Python                               : json.toolsを使うため
* RLogin                               : ssh クライアント
* Rapid Environment Editor             : editor for environment
* Remote Mouse                         : for home.
* Shell Check
* Vim(kaoriya)                         : refs. <2014-09-30-vim.md>
* WinSCP                               : Free SFTP, SCP and FTP client for Windows
* WinShot                              : boot on windows startup.
* nkf                                  : 文字コード変換
* xmllint
* エクセルパスワード瞬時解除
* 図形内文字検索置換ツール             : for Excel

### Unused

* 7-Zip                                : MSYS2のを使う
* Chat & Messenger                     : IP Messengerの高機能版。※使用者同士が表示されるので今は未使用。
* Cmder (full)                         : include conemu, clink, gitmsys                                                                                                     : PATHの通る順序を変える(msysgit じゃなく自分で入れた grep を使いたい) : <./vendor/msysgit/etc/profile> を変更(L19,L21)
* DF                                   : diff取得。diff, vimdiffに慣れたいので原則使わない。バイナリ比較に使える。
* Drop Compress                        : D&Dで一括解凍                                                                                                                      : unzip コマンド使う。
* FileSum                              : ディレクトリサイズ計測。-> unix toolsに慣れときたいのでdf,duとか無いか調べる。
* Flexible Renamer                     : unix toolsに慣れときたいのでなるべく使わない。
* GNU CoreUtils for Windows - GnuWin32 : MSYS2のを使う。for seq. 依存ライブラリ(coreutils-5.3.0-dep.zip)が必要. ref. <http                                                  : //gnuwin32.sourceforge.net/packages/coreutils.htm>
* Grep for Windows - GnuWin32 - 2.5.4  : for sjis file(基本的には使わないためパス通すときaliasでgrepsjisとかにしとく). 依存ライブラリ(grep-2-5-x-dep.zip)が必要. ref. <http : //gnuwin32.sourceforge.net/packages/grep.htm>
* JSON NotePad                         : chrome のJSONViewrプラグインが見やすい。また、vimからpython.jsontoolを呼び出す方法もある。
* Java Decompiler                      : 原則Eclipse上のプラグインとかでデコンパイルする。
* MSYS                                 : Cmderに付属のmsysgitを使う
* MinGW - Minimalist GNU for Windows   : 最新版のインストーラはproxyに引っかかるので古いものを使う。<http                                                                   : //sourceforge.net/projects/mingw/files/OldFiles/mingw-get-inst/>
* To-Do DeskList                       : cloudに持ってけるものはWunderlist。ローカル用vim unite-todo
* Tree for Windows
* WinMerge                             : diffコマンド、vimdiffに慣れたいので原則使わない。Excelファイル比較に使える。
* ag                                   : grep の高機能版。grepに慣れときたいのでなるべく使わない。
* curl                                 : cmder/msysgitに含まれてるので。
* pt                                   : grep の高機能版。grepに慣れときたいのでなるべく使わない。
* wget                                 : MSYS2のを使う

### Cmder

以下のファイルを削除(別で入れてるほうを優先したい)
	vendor/msysgit/bin
		grep.exe
		vim
		vimtutor

---

Windows - タスクバー上のアイコンを`Shift + 右クリック`からプロパティ - 作業フォルダ : `D:\admin`

---

Settings - Import : 自分の設定ファイルインポート

※変えてるもの

* Settings
	* Main
		* Main console font
			* Size : 14
			* Monospace : unchecked
		* Appearance
			* Generic - Single instance mode : unchecked(TODO Open in new Pain)
		* Tabs
			* Tabs on bottom : unchecked
			* Lazy tab switch : unchecked
			* Recent mode : unchecked
			* One tab per group : checked
			* Activate split on mouse hover : checked
				* Fixed cusor size : 0
		* Confirm
			* Confirm tab duplicating : unchecked
		* Update
			* Update settings : unchecked
	* Startup
		* Tasks
			* Add default tasks... : yes
	* Features
		* colors
		* Text cursor
			* Inactive console Text Cusor : unchecked
		* Transparency
			* Active window transparency : unchecked
	* Keys & Macro
		* Hotkeys, modifires, macros : ref. <2015-10-01-tools-services.md #Tools key unity>
			* disabled
				* Ctrl+V
				* Ctrl+W
				* Ctrl+Shift+C
				* Apps+{Down,Left,Right,Up}
			* enabled
				* Ctrl+Shift+P : Split: Duplicate ... to bottom
				* Ctrl+Shift+V : Split: Duplicate ... to right
				* Ctrl+Shift+T : Split: Maximaize/restore
				* Ctrl+Shift+C : Close active console
				* Ctrl+Shift+Q : Close all tas
				* Ctrl+Shift+{H,J,K,L} : Split: Put focus
				* Alt+V : Paste first line of clipboard contents
		* Mark/Copy
			* Select text with keyboard
				* Start selection with Shift+Arrow : checked
	* Features
		* Colors

### MSYS2

#### Initial Settings

Create bash_profile

	touch ~/.bash_profile

	if [ -e ~/.inputrc ]; then
			export INPUTRC=~/.inputrc
	else
			export INPUTRC=/etc/inputrc
	fi
	if [ -e ~/.bashrc ]; then
			. ~/.bashrc
	elif [ -e ~/.bash_profile ]; then
			. ~/.bash_profile
	elif [ -e /etc/bash_profile ]; then
			. /etc/bash_profile
	fi

Edit bat

	vim ming32_shell.bat
	start %WD%mintty -i /msys2.ico /usr/bin/bash --login -c "rm -rf /tmp/tmux* && tmux"

Workaround for openssh

	cmd //c /D "mklink D:\\admin\\Tools\\msys32\\home\\admin C:\\Users\\admin"

#### Install

	pacman -Suy

	pacman -S git
	pacman -S man-pages-posix
	pacman -S mingw-w64-i686-connect
	pacman -S p7zip
	pacman -S python
	pacman -S python2
	pacman -S tmux
	pacman -S tree
	pacman -S winpty
	pacman -S zip

#### Options...

未メンテ(.minttyrc化)

* Looks
	* Transparency : High
		* Opaque when focused : checked
* Text
	* Font : Console, 9-point
	* Locale : ja_JP
	* Character set : UTF-8
* Window
	* Default size : 80 * 25
* Terminal
	* Type : xterm-256color

#### Other Settings

* [mintty をWindowsのタスクバーにグループ化する方法 - Qiita](http://qiita.com/mo12ino/items/b6f38278c6d187ecf819)
* [](http://qiita.com/nana4gonta/items/622571c66bfe7f1c7150)

#### Tips

* コマンドプロンプトを起動(別アプリとして)
		start

##### 文字化け関連

* 出力結果がSJISのコマンドを実行する場合nkfをかます
		mvn clean package | nkf32.exe -w
* Java,Mavenの結果が化ける場合(↑だと標準出力がリアルタイムに見れないので)
		export _JAVA_OPTIONS="-Dfile.encoding=UTF-8"
		mvn hoge
		※ref. <http://d.hatena.ne.jp/black-vinegar/touch/20120211/p1>
* winptyをかませば文字化けも解決かも！

### RLogin

* 表示 - オプション設定 - キーボード
	* Metaキー設定 : D,F,B

※注意！サーバごとに設定があるらしく、全体に適用したい場合「標準の設定にする」を選択
※再注意！さらに各サーバの設定画面でキーボードの「初期化」をしないとだめっぽい。。
※二回目以降はRLogin.iniを置くだけ

#### ShellCheck

Windowsでのインストール手順

* Cabalをインストール
	* 一括(Haskell Platformごと)(簡単)
		* [Download Haskell Platform](https://www.haskell.org/platform/)
	* 個別(cabal,ghc)
		* [The Haskell Cabal](https://www.haskell.org/cabal/download.html)
		* [GHC: Download version 7.10.2](https://www.haskell.org/ghc/download_ghc_7_10_2#windows)

Shell Checkをインストール

	export PATH="/d/admin/Tools/ghc-7.10.2/bin:$PATH" # Haskell Platformごと入れた場合不要
	export http_proxy=http://USERNAME:PASSWORD@PROXYURL:PORT
	cabal update
	cabal install shellcheck
	-> C:\Users\admin\AppData\Roaming\cabal\bin # 任意にPATH追加

#### WinShot

* 基本設定
	* 接頭語 : `\F\M\D_\H\m\s_WinShot`
* 品質／減色
	* JPEG品質 : 90
* ホットキー
	* ビットマップで保存(デスクトップ)         : PrintScreen
	* ビットマップで保存(アクティブウィンドウ) : Alt + PrintScreen
* その他の設定
	* トレイアイコンのダブルクリック動作 : ビットマップで保存(矩形範囲指定)
	* 自動保存時の拡張子                 : ビットマップ .png

### Grep toolについて

Tools                       | Version | Target File Character Encoding | Installer
---                         | ---     | ---                            | ---
Cmder - msysgit             | 2.4.2   | UTF-8                          | zip
MinGW                       | 2.5.4   | UTF-8                          | exe
MSYS                        | 2.5.4   | UTF-8                          | zip
MSYS2                       | 2.21    | UTF-8                          | zip,exe
Grep for Windows - GnuWin32 | 2.5.4   | SJIS                           | zip

-> 基本的にMSYS2のを使う。(--excludeオプションは頻繁に使うため2.5.xじゃないと厳しい)
ただしSJISファイルを対象としたい場合Grep for Windowsのを使う。(.bashrcでgrepsjisなどにaliasしとく)

### On Task bar

1. Explore
1. Dos
1. Mailer
1. Internet browser
1. Vim
1. Eclipse
1. Cmder
1. Everything Search Engine
1. RLogin
1. WinSCP
1. Excel
1. Word
1. PowerPoint

## Settings

### IME

プロパティ

* 全般
	* 入力設定
		* スペースの入力 : 常に半角
	* 編集操作
		* キー設定 TODO ちょっと洗練させたい(linux,vimとあわせたい)
			* 変換           : 入力/変換済み文字なし= IME-オン。それ以外 = 未割当。(もとの設定をCtrl+Shift+変換に退避)
			* 無変換         : 入力/変換済み文字なし = IME-オフ。それ以外 = 全消去。(もとの設定をCtrl+Shift+無変換に退避)
			* Ctrl+C, Ctrl+[ : 入力/変換済み文字なし = 未割当。それ以外=全消去。(Escと同じにさせる)
			* Ctrl+J         : 全確定(Ctrl + M と同じ動きにさせる)
			* Ctrl+P         : 候補一覧表示中 = 前候補。それ以外 = 未割当(もとの設定をCtrl+Shift+hogeに退避)
			* Ctrl+N         : 入力文字のみ = 予測候補表示。候補一覧表示中 = 次候補。それ以外 = 未割当(もとの設定をCtrl+Shift+hogeに退避)
			* Ctrl+I         : 候補表示切替(TABキーと同じにする)(もとの設定をCtrl+Shift+Iに退避)
* オートコレクト
	* 全角/半角
		* 英字、数字、記号 : 常に半角に変換

### Keys

* Caps Lock -> Ctrl (use [Change Key] tool)

### PATH

* system
		Path=Path=%SystemRoot%;%SystemRoot%\system32;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;C:\Program Files\Java\jdk1.7.0_06\bin;C:\Program Files\Java\jdk1.8.0_60\bin;C:\ProgramData\Oracle\Java\javapath;C:\Program Files\WIDCOMM\Bluetooth Software\;C:\Program Files\Broadcom\Broadcom 802.11\Driver;C:\Program Files\Intel\DMIX;C:\Program Files\Graphviz 2.28\bin;C:\oraclexe\app\oracle\product\11.2.0\server\bin
* user
		PATH=PATH=C:\Program Files\Microsoft Office\Office14;C:\Users\admin\AppData\Local\Pandoc\;C:\Users\admin\AppData\Roaming\cabal\bin;C:\Python27;C:\Python34;D:\admin\Tools\apache-maven-3.0.4\bin;D:\admin\Tools\apache-maven-3.3.3-bin\apache-maven-3.3.3\bin;D:\admin\Tools\checkbashisms;D:\admin\Tools\vim74-kaoriya-win32;D:\admin\Tools\libxml2-2.7.8.win32\bin;D:\admin\Tools\nkfwin\vc2005\win32(98,Me,NT,2000,XP,Vista,7)Windows-31J;D:\admin\Tools\ctags58j2bin;D:\admin\Tools\cmigemo-default-win32;D:\admin\Tools\jad158g.win;D:\admin\Tools\pt;D:\admin\Tools\ag4mingw-master;D:\admin\Tools\Lynx286rel4TH;D:\admin\Tools\xz-5.2.1-windows\bin_i686

## Directory hierarchy (office)

* /d/admin
	* Backup
	* Desktop
	* Development
		* gist
		* script
		* workspace
		* dotfiles
	* Documents
		* caputure
		* configuration
		* memolist
		* misc
		* references
		* spell
		* task
		* tmp
		* todo
	* Downloads
	* Shortcuts
	* Tmp
	* Tools
	* dotfiles(junction)
			cmd //c "mklink /J D:\\admin\\dotfiles D:\\admin\\Development\\dotfiles"
	* memolist(junction)
			cmd //c "mklink /J D:\\admin\\memolist D:\\admin\\Documents\\memolist"
	* c_home(symbolic link to /c/Users/admin)
			cmd //c "mklink /D D:\\admin\\c_home C:\\Users\\admin"
* home(/c/Users/admin)
	* d_home(symbolic link to /d/admin)
			cmd //c "mklink /D C:\\Users\\admin\\d_home D:\\admin"

以下のディレクトリを↑の場所に変更

* Desktop
* Downloads
* Documents

## Tips

* エクスプローラーでドットファイル作るときに、末尾もドットにしないといけない(.gitignore. とか)
* タスクバーのプログラム実行時の引数、作業ディレクトリを変更する。ref. [Windows/Windows7/タスクバーに固定したアプリの引数を指定する方法 - TOBY SOFT wiki](http://tobysoft.net/wiki/index.php?Windows%2FWindows7%2F%A5%BF%A5%B9%A5%AF%A5%D0%A1%BC%A4%CB%B8%C7%C4%EA%A4%B7%A4%BF%A5%A2%A5%D7%A5%EA%A4%CE%B0%FA%BF%F4%A4%F2%BB%D8%C4%EA%A4%B9%A4%EB%CA%FD%CB%A1)
	* -> タスクバー上のアイコンを`Shift + 右クリック`からプロパティを選択
* 資格情報マネージャの削除
		cmdkey /list
		cmdkey /delete {target name}

## 引っ越し時にやること

### 持ってくもの

* Office
	* 辞書ファイル
			C:\Users\admin\AppData\Roaming\Microsoft\UProof
	* Themes,Templates (TODO どちらかでよいかも)
			C:\Users\admin\AppData\Roaming\Microsoft\Templates
			C:\Users\admin\AppData\Roaming\Microsoft\Templates\Document Themes
* /d/admin配下のGithub管理してないもの
	* memolist
		* local
* $HOMEフォルダ配下のGitHub管理してないもの
	* hoge.local

### 出るときにやること

* 各種設定ファイルエクスポート(configurationディレクトリへ格納)
	* ChromeのBookmark
	* Cmder - Settings - Keys & Macro - Export
	* Word,Excel,PowerPoint - オプション - クイックアクセスツールバー - インポート/エクスポート
	* RLogin.ini
* 最新の環境変数PATHを当ファイルに更新
* 「プログラムと機能」からアンインストール
* [Change Key] toolでの設定を戻す
* IMEの設定を戻す
* レジストリの設定を戻す
	* Edit with GVim -> refs. <2014-09-30-vim.md #その他>
* メールファイルをバックアップ TODO 手順
* 以下の「場所」を標準に戻す
	* Desktop
	* Documents
	* Downloads
* ショートカット、シンボリックリンクを削除

### 入るときにやること

↑の逆

