# Title: Windows

Date: 2014-12-04 15:00
Tags: []
Categories: []

---

## Tools

### List

* C/Migemo for Windows     : For vim-migemo
* Cabal                    : For ShellCheck
* Change Key               : キーボード配置変更(swap Ctrl and Caps Lock)
* Chat & Messenger         : IP Messengerの高機能版。\* 使用者同士が表示されるので場合によっては使わない
* Eclipse                  : Refs. <2014-09-09-eclipse.md>
* Everything Search Engine
* GCViewer
* GHC                      : For Cabal
* Google Chrome            : Refs. <2014-11-13-chrome.md>
* MSYS2
* Pandoc                   : markdown - textile 変換 等。
* Rapid Environment Editor : editor for environment
* Remote Mouse             : For home.
* ShellCheck
* Vim(kaoriya)             : Refs. <2014-09-30-vim.md>
* WinSCP                   : Free SFTP, SCP and FTP client for Windows
* WinShot                  : boot on windows startup.
* XZ Utils                 : For unarchive msys2 install file
* kSar
* nkf                      : 文字コード変換

Caution

* エクセルアドインは Ref. <2014-09-18-microsoft-excel.md>
* MSYS2内で利用するものは Ref. <# MSYS2>

#### Rare, Deprecated

* Apache JMeter
* Apache Maven
* Apache Tomcat
* CarotDAV                       : WebDav client. For Gxxxxmax Collaboration
* DF                             : 基本diff使うが。フォルダ比較、バイナリ比較時に使う
* DropCompres                    : 一括unzipなどで使用。基本MSYS2で行うがたまに使う
* FileSum                        : 基本MSYS2(du,df)を使う
* Flexible Renamer               : 基本MSYS2(rename,mv)を使う
* Java Decompiler (JD-GUI)       : 基本Java Decompiler Eclipse Plug-inを使う
* Git for Windows (Portable Git) : 基本MSYS2を使うが初回cloneできないことがあるためこっちのgit-cmd.exe使う Refs. [Releases · git-for-windows/git · GitHub](https : //github.com/git-for-windows/git/releases)
* SQL Developer
* SizeOf                         : Java インスタンスのメモリサイズ計測 Refs. [いー ドット ぷりんとすたっくとれーす                                  : Javaのインスタンスが使っているメモリサイズをみたい](http : //edotprintstacktrace.blogspot.jp/2007/04/java.html)
* TeraTerm                       : 基本MSYS2 (ssh)を使う

### On Task bar

1. Explore
1. Dos
1. Mintty (bat)
1. Mailer
1. Internet browser
1. Vim
1. Eclipse
1. Everything Search Engine
1. WinSCP
1. Excel
1. Word
1. PowerPoint

### Details

#### MSYS2

##### Initial Settings

* Create bash_profile

	touch ~/.bash_profile

	if [ -e ~/.inputrc ]; then
			export INPUTRC=~/.inputrc
	else
			export INPUTRC=/etc/inputrc
	fi
	if [ -e ~/.bashrc ]; then
			. ~/.bashrc
	elif [ -e ~/.bash_profile ]; then
			. ~/.bash_profile
	elif [ -e /etc/bash_profile ]; then
			. /etc/bash_profile
	fi

* Edit bat

	vim ming32_shell.bat
	start %WD%mintty -i /msys2.ico /bin/env CHERE_INVOKING=1 /usr/bin/bash --login %* -c "export CHERE_INVOKING=1 && tmux"

* Edit fstab (パーミッションのため)
	vim /etc/fstab
	noacl -> acl
	Ref. [MSYS2と格闘 (2) - できないことはやりたくない](http://yaritakunai.hatenablog.com/entry/2014/12/09/202743)
	Caution: ただ全ファイルが777になってしまうっぽく出来ればやりたくない

* Workaround for openssh

	mkdir /home
	cmd //c "mklink /D D:\\admin\\Tools\\msys32\\home\\admin D:\\admin" 2>&1 | nkf32.exe -w

* Workaround for git prompt
	`git`を`winpty git`にaliasしてるので、
	git-prompt.shのgitコマンドをすべて\gitにエスケープが必要っぽい

* git 初回cloneが失敗することがある(原因不明)
	* -> TODO Workaround としてGit for Windowsのgit-cmd.exeで代替可能

##### Install

	pacman -Suy

	pacman -S ctags
	pacman -S diffutils
	pacman -S expect # For telnet auto login
	pacman -S gcc # For vimproc build
	pacman -S git
	pacman -S man-pages-posix
	pacman -S make # For vimproc build
	pacman -S mingw-w64-i686-connect # For ssh proxy command
	pacman -S p7zip
	pacman -S procps # pgrep, pkill, watch, etc.
	pacman -S python
	pacman -S python2
	pacman -S tmux
	pacman -S tar
	pacman -S tree
	pacman -S winpty
	pacman -S zip

Caution

* xmllintはデフォルトで入ってるっぽい

##### Options...

Refs. .minttyrc

color設定は以下のhybridを使う(TODO vimのエラーメッセージが見づらい(default colorschemeのとき)

* [Hybrid color settings for the Cygwin mintty terminal. $ cat .minttyrc-hybrid ; ~/.minttyrc · GitHub](https://gist.github.com/wakuworks/2232246c4c1b6ce2c019)
* [mintty-color-schemes/base16-tomorrow.minttyrc at master · oumu/mintty-color-schemes · GitHub](https://github.com/oumu/mintty-color-schemes/blob/master/base16-mintty/base16-tomorrow.minttyrc)

##### Other Settings

* [mintty をWindowsのタスクバーにグループ化する方法 - Qiita](http://qiita.com/mo12ino/items/b6f38278c6d187ecf819)
		リンク先:
		%windir%\system32\cmd.exe /c "D:\admin\Tools\msys32\mingw32_shell.bat"
		作業フォルダー:
		D:\admin
* [msys2での$HOMEとOpenSSHでのホームディレクトリの違い - Qiita](http://qiita.com/nana4gonta/items/622571c66bfe7f1c7150)

##### Tips

* コマンドプロンプトを起動(別アプリとして)
		start
* システムの関連付けでファイルを開く
		start hoge
	* エクスプローラを開く
			start .
* SJISのファイルをgrepしたい場合、一時的に Options - Text - Character setをSJISに変更する

##### 文字化け関連

* 出力結果がSJISのコマンドを実行する場合nkfをかます
		mvn clean package | nkf32.exe -w
	* 標準エラーも対応
		mvn clean package 2>&1 | nkf32.exe -w
* winptyをかませば文字化けも解決することがある
		winpty ping localhost
* Java,Mavenの結果が化ける場合(↑だと標準出力がリアルタイムに見れないので)
		export _JAVA_OPTIONS="-Dfile.encoding=UTF-8"
		mvn hoge
Ref. [mavenで文字化けを解消するための備忘録 - 備忘録のようなもの](http://d.hatena.ne.jp/black-vinegar/touch/20120211/p1)

#### Vim

* 翻訳用辞書をローカルに保存
	* ファイル取得
			[GENE95 Dictionary](http://www.namazu.org/~tsuchiya/sdic/data/gene.html)
	* ローカルに格納
			~/vimfiles/dict/gene95/GENE.TXT
	* UTF8に変換
			nkf -w --overwrite ~/vimfiles/dict/gene95/GENE.TXT

* vimprocをビルド(For MSYS2)
		cd ~/vimfiles/bundle/vimproc
		make -f make_cygwin.mak

#### Eclipse

Preferences

* Man pages : D:\admin\Tools\msys32\usr\bin\man.exe
* Shell Script
	* Interpreters
		* Add... : bash.exe - D:\admin\Tools\msys32\usr\bin\bash.exe

#### ShellCheck

Windowsでのインストール手順

* Cabalをインストール
	* 一括(Haskell Platformごと)(簡単)
		* [Download Haskell Platform](https://www.haskell.org/platform/)
	* 個別(cabal,ghc)
		* [The Haskell Cabal](https://www.haskell.org/cabal/download.html)
		* [GHC: Download version 7.10.2](https://www.haskell.org/ghc/download_ghc_7_10_2#windows)

Shell Checkをインストール

	export PATH="/d/admin/Tools/ghc-7.10.2/bin:$PATH" # Haskell Platformごと入れた場合不要
	export http_proxy=http://USERNAME:PASSWORD@PROXYURL:PORT
	cabal update
	cabal install shellcheck
	-> C:\Users\admin\AppData\Roaming\cabal\bin # 任意にPATH追加

#### WinShot

* 基本設定
	* 接頭語 : `\F\M\D_\H\m\s_WinShot`
* 品質／減色
	* JPEG品質 : 90
* ホットキー
	* ビットマップで保存(デスクトップ)         : PrintScreen
	* ビットマップで保存(アクティブウィンドウ) : Alt + PrintScreen
* その他の設定
	* トレイアイコンのダブルクリック動作 : ビットマップで保存(矩形範囲指定)
	* 自動保存時の拡張子                 : ビットマップ .png

## Settings

### IME

プロパティ

* 全般
	* 入力設定
		* スペースの入力 : 常に半角
	* 編集操作
		* キー設定 TODO ちょっと洗練させたい(linux,vimとあわせたい)
			* 変換           : 入力/変換済み文字なし= IME-オン。それ以外 = 未割当。(もとの設定をCtrl+Shift+変換に退避)
			* 無変換         : 入力/変換済み文字なし = IME-オフ。それ以外 = 全消去。(もとの設定をCtrl+Shift+無変換に退避)
			* Ctrl+C, Ctrl+[ : 入力/変換済み文字なし = 未割当。それ以外=全消去。(Escと同じにさせる)
			* Ctrl+J         : 全確定(Ctrl + M と同じ動きにさせる)
			* Ctrl+P         : 候補一覧表示中 = 前候補。それ以外 = 未割当(もとの設定をCtrl+Shift+hogeに退避)
			* Ctrl+N         : 入力文字のみ = 予測候補表示。候補一覧表示中 = 次候補。それ以外 = 未割当(もとの設定をCtrl+Shift+hogeに退避)
			* Ctrl+I         : 候補表示切替(TABキーと同じにする)(もとの設定をCtrl+Shift+Iに退避)
* オートコレクト
	* 全角/半角
		* 英字、数字、記号 : 常に半角に変換

### Keys

* Caps Lock -> Ctrl (use [Change Key] tool)

### PATH

* System Variables
		Path=D:\admin\Tools\msys32\usr\bin;C:\Program Files\Java\jdk1.7.0_06\bin;C:\Program Files\Java\jdk1.8.0_60\bin;%SystemRoot%;%SystemRoot%\system32;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;C:\Program Files\WIDCOMM\Bluetooth Software\;C:\Program Files\Broadcom\Broadcom 802.11\Driver;C:\Program Files\Intel\DMIX;C:\Program Files\Graphviz 2.28\bin;C:\oraclexe\app\oracle\product\11.2.0\server\bin
* User Variables
		HOME=D:\admin
		PATH=C:\Program Files\Microsoft Office\Office14;C:\Users\admin\AppData\Local\Pandoc\;C:\Users\admin\AppData\Roaming\cabal\bin;D:\admin\Tools\apache-maven-3.0.4\bin;D:\admin\Tools\apache-maven-3.3.3-bin\apache-maven-3.3.3\bin;D:\admin\Tools\checkbashisms;D:\admin\Tools\vim74-kaoriya-win32;D:\admin\Tools\nkfwin\vc2005\win32(98,Me,NT,2000,XP,Vista,7)Windows-31J;D:\admin\Tools\cmigemo-default-win32;D:\admin\Tools\xz-5.2.1-windows\bin_i686

## Directory hierarchy (office)

* /d/admin
	* Backup
	* Desktop
	* Development
		* dotfiles
		* gist
		* scripts
		* workspace
	* Documents
		* caputure
		* configuration
		* memolist
		* misc
		* references
		* spell
		* task
		* tmp
		* todo
	* Downloads
	* Shortcuts
	* Tmp
	* Tools
	* vimfiles
		* bundle
		* dict
			* gene95
				* GENE.TXT
			* utf-8
				* {for migemo dict}
	* dotfiles(junction)
			cmd //c "mklink /J D:\\admin\\dotfiles D:\\admin\\Development\\dotfiles"
	* memolist(junction)
			cmd //c "mklink /J D:\\admin\\memolist D:\\admin\\Documents\\memolist"

以下のディレクトリを↑の場所に変更

* Desktop
* Downloads
* Documents

## Desktop icons

* Today
* admin (C drive)
* admin (D drive)
* ごみ箱
* コンピュータ
* ネットワーク
* IE
* Others

## Tips

* エクスプローラーでドットファイル作るときに、末尾もドットにしないといけない(.gitignore. とか)
* タスクバーのプログラム実行時の引数、作業ディレクトリを変更する。ref. [Windows/Windows7/タスクバーに固定したアプリの引数を指定する方法 - TOBY SOFT wiki](http://tobysoft.net/wiki/index.php?Windows%2FWindows7%2F%A5%BF%A5%B9%A5%AF%A5%D0%A1%BC%A4%CB%B8%C7%C4%EA%A4%B7%A4%BF%A5%A2%A5%D7%A5%EA%A4%CE%B0%FA%BF%F4%A4%F2%BB%D8%C4%EA%A4%B9%A4%EB%CA%FD%CB%A1)
	* -> タスクバー上のアイコンを`Shift + 右クリック`からプロパティを選択
* 資格情報マネージャの削除
		cmdkey /list
		cmdkey /delete {target name}

### PATH

* Windowsのホームディレクトリ
		$USERPROFILE (%USERPROFILE%)

## 引っ越し時にやること

### 持ってくもの

* Office
	* 辞書ファイル
			C:\Users\admin\AppData\Roaming\Microsoft\UProof
	* IMEの辞書ファイルを保存
			C:\Users\admin\AppData\Roaming\Microsoft\IMJP14\imjp14cu.dic
	* Themes,Templates (TODO どちらかでよいかも)
			C:\Users\admin\AppData\Roaming\Microsoft\Templates
			C:\Users\admin\AppData\Roaming\Microsoft\Templates\Document Themes
* /d/admin配下のGithub管理してないもの
	* memolist
		* local
	* scripts
		* local
* $HOMEフォルダ配下のGitHub管理してないもの
	* hoge.local

### 出るときにやること

* 各種設定ファイルエクスポート(configurationディレクトリへ格納)
	* ChromeのBookmark
	* Word,Excel,PowerPoint - オプション - クイックアクセスツールバー - インポート/エクスポート
	* RLogin.ini
* 最新の環境変数PATHを当ファイルに更新
* 「プログラムと機能」からアンインストール
* [Change Key] toolでの設定を戻す
* IMEの設定を戻す
* レジストリの設定を戻す
	* Edit with GVim -> refs. <2014-09-30-vim.md #その他>
* メールファイルをバックアップ TODO 手順
* 以下の「場所」を標準に戻す
	* Desktop
	* Documents
	* Downloads
* ショートカット、シンボリックリンクを削除

### 入るときにやること

↑の逆

