# Title: Microsoft Excel

Date: 2014-09-18 14:53
Tags: []
Categories: []

---

## Prelude

特に断りのない場合Excel 2010を対象とする

## Shortcut keys

* 繰り返し :
        F4
* 日付入力 :
        Ctrl + ;
* 時刻入力 :
        Ctrl + :
* 行を非表示 :
        Ctrl + 9
* 行を表示 :
        Ctrl + Shift + 9
* 列を非表示 :
        Ctrl + 0
* 列を表示 :
        Ctrl + Shift + 0
* 数式を表示 :
        Ctrl + Shift + @
* 取り消し線トグル
        Ctrl + 5
* 表示しているセルだけ選択
        Alt + ;

## Settings

* ファイル - オプション
    * 文章校正
        * オートコレクトのオプション
            * 2文字目を小文字にする : unchecked
    * クイック アクセス ツール バー
        * インポート/エクスポート : ユーザ設定ファイルをインポート
    * アドイン
        * 設定 : 有効なアドイン選択
    * セキュリティセンター
        * セキュリティセンターの設定
            * 信頼できる場所
                * プライベートネットワーク上にある信頼できる場所を許可する : checked
                * 新しい場所の追加
                    * パス : 追加したい場所(e.g. \\hostA\)
                    * この場所のサブフォルダーも信頼する: checked

## Add-in

* Relax Tools                                      : 主にオートシェイプ内文字列検索のための使用 : [Releases · RelaxTools/RelaxTools-Addin](https://github.com/RelaxTools/RelaxTools-Addin/releases)
* taskline - エクセルガントチャート                : [EXCELマクロでガントチャートを作ってみた - ITレシピ](http://mitsuyahiromi.sakura.ne.jp/fswiki/wiki.cgi?page=EXCEL%A5%DE%A5%AF%A5%ED%A4%C7%A5%AC%A5%F3%A5%C8%A5%C1%A5%E3%A1%BC%A5%C8%A4%F2%BA%EE%A4%C3%A4%C6%A4%DF%A4%BF)
* エクセルパスワード瞬時解除ForExcel2007/2010/2013 : [エクセルパスワード瞬時解除ForExcel2007/2010/2013の詳細情報 : Vector ソフトを探す！](http://www.vector.co.jp/soft/winnt/business/se499814.html)

### Deprecated

* CombinationCell - セルの結合    : UNDOできなくなる, Alt+↓とかもつぶされる(Dropdown表示でよく使う)
* かんたんレイアウト - セルの結合 : undoできなくなるので

### Relax Tools

よく使う機能

* 開く・検索・印刷
    * 検索
        * セル・シェイプの正規表現検索
* チェック・編集・変換
    * 文字・日付
        * 半角へ変換 (Caution: 一括で適用するとカタカナも変わってしまう)
* 書式・文書作成支援
    * ドキュメント支援
        * 英数字記号を半角、カタカナを全角に変換 (Caution: [チェック・編集・変換 - 文字・日付 - 半角へ変換]は半角カタカナに変わってしまうので使わない)
* ブック・シート
    * シート管理
        * シート名変更

## Function

* DMAX, DMIN - 条件付きで最大値、最小値を求める
        =DMAX(B2:D14,3,F2:F3)
* MEDIAN - 中央値 :
        =MEDIAN
* TRIMMEAN - 特異な値を除いた平均 :
        =TRIMMEAN
* MATCH - 特定の値を検索し相対的な位置を返す :
        =MATCH("名古屋",A1:A4,0)
* OFFSET - 相対的なセル範囲を取得 :
        // 書式
        OFFSET((開始セル),(範囲開始位置の行オフセット), (範囲開始位置の列オフセット), (範囲行), (範囲列))
        // B6セルから高さ4, 幅1でセルの範囲を取得する場合は次のように記述します。
        =OFFSET(B6,0,0,4,1)
    * OFFSETを使って範囲内のMAXを取る :
            =MAX(OFFSET(B6,0,0,4,1))

### Complex

* 列名を利用してVLOOKUP
        =VLOOKUP($B3,データシート!$A$2:$AO$1000,MATCH(C1,データシート!1:1,),FALSE)

## Useful Feature

* ホーム
    * スタイル
        * テーブルとしての書式設定
* ピボットテーブルツール
    * ピボットテーブル
        * オプション
            * 更新時にセル書式を保持する

## Tips

* グラフでX軸とY軸を[グラフツール - 行/列の入れ替え]で入れ替えれる
* グラフで基準線(目標線)を入れる
    * 目標値のデータを追加し、目標値のグラフだけを指定し[グラフの種類を変更]
    * ref. [グラフに目標値を入れてみる](http://excel-magic.com/post-14/)
* 複数ブックを一括で閉じる
        Shift + ×ボタン
* VLOOKUPなどでマッチしないとき0が返ってしまう
    * -> 末尾に`&""`を結合する
            =VLOOKUP(D2,A2:B5,2,FALSE)&""
            \* `=A2`などのただのセル参照でも使える
* セル参照した時に小数点以下が表示されてしまう
    * -> ROUNDかます
            =ROUND(A1,2)
* xlsxファイルをShift+右クリックで[読み取り専用で開く]ができる
* "このブックには、ほかのデータソースへのリンクが含まれています。" の対策
    1. データ - リンクの編集 -> リンク元を確認
    1. 検索 - 検索する文字列:↑で確認したリンク元のファイル名 検索場所:ブック 検索対象:数式
    1. 修正 or 削除
    \* たまに見つからない。(その場合は上記[手順1.]でリンクの解除をすればよさそう)
* 検索・置換時にワイルドカードを使う
    * `*` - 任意の文字
    * `?` - 任意の一文字
    * `~` - ↑のエスケープ
* 改行コードを検索/置換する ref. [セル内の改行を検索/置換する 日経トレンディネット](http://trendy.nikkeibp.co.jp/article/tec/excel/20040308/107599/?rt=nocnt)
        [検索する文字列]ボックスで`<C-J>`を入力
* 全角英数字を半角に変換
    * -> RelaxTools 使う(標準でやろうとすると意外とめんどい(一旦関数適用してコピペとか))
* 数式セルのみ選択(一括で書式変更などするため)
    * ホーム
        * 編集
            * 検索と選択
                * 数式
* SUM関数とSUBTOTAL関数の使い分け
    * SUBTOTAL関数はサマリ以外の集計も可能
    * SUBTOTAL関数は非表示セルは集計対象外

## Rules

### Table - テーブルについて

Work {{{

以下選択肢がある

* 標準のテーブルツール
    * メリット) 集計が用意、ピボットへの変換、ヘッダ行でオートフィルタ、テーブルスタイルのオプションで簡単に縞模様をトグルできる、標準機能
* Relax tools のかんたん表
    * メリット) レイアウトがきれい(データ行は点線で区切られるのが)、ヘッダ行の数を簡単に指定できる

-> 前者を使う
-> 後者のほうがだいぶお気軽なのでcase by caseにする
}}}

#### テーブルスタイルの設定

* [ホーム - スタイル - テーブルとして書式設定]
* [テーブルスタイル (中間) 16]を複製
* テーブル全体
    * 書式
        * 罫線 : 真ん中行を取り消し線に変更
* 既定に設定

TODO 作成したテーブルスタイルはブック内しか利用できない

\* [テーブル]でなく[表]を手動で作るときも↑とあわせ、ヘッダ行に[青、アクセント 1]を指定する

#### テーブルスタイルの解除

* テーブルツール
    * デザイン
        * テーブルスタイル
            * クリア
        * ツール
            * 範囲に変換

TODO もっと簡単にできないか

### Cell color - セル色(前景/背景色)

* font color
    * 数式セル : 標準の色 - 紫

以前は背景色を変えていたが、テーブルと親和性低い(デフォルトだと一行ごとに背景色変わるため)のでやめる

\* 前述した[ホーム - 編集 - 検索と選択- 数式]から選択し設定する

TODO ただし空白セルが数式か本当の空白か区別がつかない
TODO 自動設定したい

## Refs

* [Excel のショートカット キーとファンクション キーについて](http://office.microsoft.com/ja-jp/excel-help/HP010073848.aspx)

## TODOs

* TODO クイックアクセスツールバーからRelax Toolsの分が消失することがある

